<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fairview Prototype</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="topbar">
        <div class="title">
          <h1>Fairview</h1>
          <div class="subtitle">A sociological city-growth simulation</div>
        </div>
        <div class="meta">
          <div class="chip" id="stage-chip">Stage 1</div>
          <div class="chip" id="turn-chip">Turn 1</div>
          <div class="chip" id="year-chip">Year 1</div>
          <div class="chip" id="budget-chip">Budget 100</div>
          <div class="chip" id="seed-chip">Seed 1</div>
        </div>
      </header>

      <main class="main">
        <section class="left">
          <div class="panel">
            <div class="panel-header">
              <h2>City Grid</h2>
              <div class="view-toggle" role="group" aria-label="Theory view">
                <button class="toggle active" data-view="income" aria-pressed="true">Income</button>
                <button class="toggle" data-view="functionalism" aria-pressed="false">Functionalism</button>
                <button class="toggle" data-view="conflict" aria-pressed="false">Conflict</button>
              </div>
            </div>
            <div id="legend" class="legend"></div>
            <div id="grid" class="grid" role="grid" aria-label="City grid"></div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <h2>District Inspector</h2>
            </div>
            <div id="inspector" class="inspector">Hover or focus a district to see details.</div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <h2>Newsfeed</h2>
              <select id="tone-select" class="sort" aria-label="Tone mode">
                <option value="academic">Academic</option>
                <option value="civic">Civic</option>
                <option value="satirical">Satirical</option>
              </select>
            </div>
            <div id="newsfeed" class="newsfeed"></div>
          </div>
        </section>

        <section class="right">
          <div class="panel">
            <div class="panel-header">
              <h2>Simulation Setup</h2>
            </div>
            <div class="setup">
              <label class="field">
                <span>Seed</span>
                <input id="seed-input" type="number" min="1" step="1" />
              </label>
              <label class="field">
                <span>Scenario</span>
                <select id="scenario-select"></select>
              </label>
              <button id="start-sim" class="secondary">Start</button>
            </div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <h2>Controls</h2>
              <button id="next-turn" class="primary">Next Turn</button>
            </div>
            <div class="control-row">
              <div class="metric">
                <div class="label">Growth</div>
                <div id="growth" class="value"></div>
              </div>
              <div class="metric">
                <div class="label">Strain</div>
                <div id="strain" class="value"></div>
              </div>
              <div class="metric">
                <div class="label">Legitimacy</div>
                <div id="legitimacy" class="value"></div>
              </div>
            </div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <h2>Institution Tokens</h2>
              <div class="panel-note">Select then click a district. One placement per turn.</div>
            </div>
            <div id="placement-info" class="panel-note"></div>
            <div id="placements" class="placement-list"></div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <h2>Policy Cards</h2>
              <div class="panel-note">Select up to 2. Budget resets each turn.</div>
            </div>
            <div class="policy-controls">
              <div id="policy-tags" class="tag-list"></div>
              <select id="policy-sort" class="sort">
                <option value="default">Sort: default</option>
                <option value="cost">Sort: cost</option>
                <option value="impact">Sort: impact</option>
              </select>
            </div>
            <div id="policies" class="card-list"></div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <h2>Event</h2>
            </div>
            <div id="event" class="event"></div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <h2>Dashboards</h2>
            </div>
            <div class="dashboards">
              <div class="dashboard">
                <h3>Functionalism</h3>
                <div id="func-metrics" class="metric-list"></div>
              </div>
              <div class="dashboard">
                <h3>Conflict</h3>
                <div id="conf-metrics" class="metric-list"></div>
              </div>
            </div>
          </div>

          <div class="panel">
            <div class="panel-header">
              <h2>Runs</h2>
              <div class="panel-actions">
                <button id="export-json" class="secondary">Export JSON</button>
                <button id="export-csv" class="secondary">Export CSV</button>
              </div>
            </div>
            <div class="panel-note">Exports include seed, policies, metrics, and stage shifts.</div>
            <div id="runs" class="runs"></div>
            <button id="replay-seed" class="secondary">Replay Seed</button>
          </div>
        </section>
      </main>
    </div>

    <div id="summary-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Turn summary">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Turn Summary</h2>
          <div class="modal-actions">
            <button id="summary-save" class="secondary">Save Run</button>
            <button id="summary-close" class="primary">Close</button>
          </div>
        </div>
        <div id="summary-body" class="summary-body"></div>
      </div>
    </div>

    <div id="policy-drawer" class="drawer hidden" role="dialog" aria-modal="true" aria-label="Policy details">
      <div class="drawer-content">
        <div class="drawer-header">
          <h2 id="drawer-title">Policy Details</h2>
          <button id="drawer-close" class="primary">Close</button>
        </div>
        <div id="drawer-body" class="drawer-body"></div>
      </div>
    </div>

    <div id="stage-banner" class="stage-banner hidden" role="status" aria-live="polite"></div>

    <div id="endgame-modal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Endgame achievements">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Endgame Achievements</h2>
          <button id="endgame-close" class="primary">Close</button>
        </div>
        <div id="endgame-body" class="summary-body"></div>
      </div>
    </div>

    <script type="module" src="app.js"></script>
  </body>
</html>
